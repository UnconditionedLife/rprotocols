{
  "lexicon": 1,
  "id": "org.rprotocols.query.view.need",
  "type": "query",
  "parameters": {
    "type": "params",
    "required": ["uri"],
    "properties": {
      "uri": { "type": "string", "description": "at:// URI of the Need record" },
      "childrenLimit": { "type": "integer", "default": 50, "minimum": 1, "maximum": 200 },
      "childrenCursor": { "type": "string" },
      "parentsLimit": { "type": "integer", "default": 20, "minimum": 1, "maximum": 100 },
      "includeRelatedProtocols": { "type": "boolean", "default": true },
      "includeAncestorUris": { "type": "boolean", "default": false },
      "includeDescendantCount": { "type": "boolean", "default": true }
    }
  },
  "output": {
    "type": "object",
    "required": ["need"],
    "properties": {
      "need": {
        "type": "unknown",
        "description": "Full Need record value (org.rprotocols.record.need)"
      },
      "parents": {
        "type": "array",
        "description": "Direct parents (ordered by each edge's 'order', then title)",
        "items": {
          "type": "object",
          "required": ["uri", "title"],
          "properties": {
            "uri": { "type": "string" },
            "title": { "type": "string" }
          }
        }
      },
      "children": {
        "type": "object",
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["uri", "title"],
              "properties": {
                "uri": { "type": "string" },
                "title": { "type": "string" },
                "order": { "type": "integer" }
              }
            }
          },
          "cursor": { "type": "string" }
        }
      },
      "ancestors": {
        "type": "array",
        "items": { "type": "string" },
        "description": "URIs of all ancestors (optional; includeAncestorUris=true). Computed by indexer."
      },
      "descendantCount": {
        "type": "integer",
        "description": "Total count of descendants (optional; includeDescendantCount=true). Computed by indexer."
      },
      "relatedProtocols": {
        "type": "array",
        "description": "Snapshot of protocols that address this Need (if includeRelatedProtocols=true).",
        "items": {
          "type": "object",
          "required": ["uri", "title"],
          "properties": {
            "uri": { "type": "string" },
            "title": { "type": "string" },
            "v": { "type": "string" },
            "adoptionCount": { "type": "integer" },
            "followCount": { "type": "integer" }
          }
        }
      },
      "counts": {
        "type": "object",
        "properties": {
          "followers": { "type": "integer" }
        }
      }
    }
  }
}
