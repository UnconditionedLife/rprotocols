{
  "lexicon": 1,
  "id": "org.rprotocols.record.need",
  "type": "record",
  "record": {
    "type": "object",
    "description": "A Need is a purpose/tension that protocols address. Needs form a hierarchy.",
    "required": ["title", "body", "needShort", "needFull", "v"],
    "properties": {
      "title": { "type": "string", "maxLength": 160 },
      "body":  { "type": "string", "description": "Single-post author text (freeform; may include sections)." },

      "needShort": { "type": "string", "maxLength": 64, "description": "≤4 words handle" },
      "needFull":  { "type": "string", "maxLength": 300 },

      "context": { "type": "string", "maxLength": 300 },
      "purpose": { "type": "string", "maxLength": 300 },

      "levels": { "type": "array", "maxLength": 5, "items": { "type": "string" },
        "description": "IRIs from Levels of Organization (first = primary)" },

      "rlf": {
        "type": "array",
        "description": "Radical Life Functions links.",
        "items": {
          "type": "object",
          "required": ["iri", "role"],
          "properties": {
            "iri": { "type": "string" },
            "role": { "type": "string", "enum": ["need","context","purpose","level"] },
            "weight": { "type": "number", "minimum": 0, "maximum": 1 }
          }
        }
      },

      "relatedProtocols": { "type": "array", "items": { "type": "string" } },
      "relatedNeeds":     { "type": "array", "items": { "type": "string" } },

      "parent":   { "type": "string", "description": "at:// of parent Need (null/omitted = root)" },
      "order":    { "type": "integer", "description": "Sibling order hint (smaller = earlier)" },
      "ancestors":{ "type": "array", "items": { "type": "string" }, "description": "Root→…→parent path, maintained by server" },
      "treeId":   { "type": "string", "description": "Stable id for the tree this Need belongs to" },

      "tags":  { "type": "array", "maxLength": 16, "items": { "type": "string", "maxLength": 32 } },
      "lang":  { "type": "string", "description": "BCP‑47, e.g., en" },

      "v":        { "type": "string", "description": "semver" },
      "prev":     { "type": "string", "description": "at:// of prior version (same lineage)" },
      "forkOf":   { "type": "string", "description": "at:// of ancestor if forked" },
      "checksum": { "type": "string", "description": "sha256 of `body`" },

      "adoptEnabled":  { "type": "boolean", "default": false },
      "followEnabled": { "type": "boolean", "default": true },

      "createdAt": { "type": "string", "format": "datetime" }
    }
  }
}
